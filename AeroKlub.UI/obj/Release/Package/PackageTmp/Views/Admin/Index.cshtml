@model AeroKlub.UI.Models.PlaneListViewModel

@using System.Globalization

@{
	Layout = null;
}


<!DOCTYPE html>
<html>
<head>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="~/css/nouislider.css" rel="stylesheet" />
	<script src="~/Scripts/nouislider.js"></script>
	<link href="~/css/nouislider.min.css" rel="stylesheet" />
	<script src="~/Scripts/nouislider.min.js"></script>
	<script src="~/Scripts/wNumb.js"></script>
	<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
	<script src="~/Scripts/jquery-3.3.1.min.js"></script>
	<script src="~/Scripts/bootstrap.min.js"></script>
	<link href="~/Content/NavbarStyle.css" rel="stylesheet" />

	<style>
		table, th, td {
			border: 2px solid black;
			padding: 10px;
		}

		td {
			position: relative;
		}

		.noUi-tooltip {
			display: none;
		}

		.noUi-active .noUi-tooltip {
			display: block;
		}

		
	</style>
</head>
<body>

	@if (TempData["message"] != null)
	{
		<script src="~/Scripts/bootbox.min.js"></script>
		<script src="~/Scripts/bootbox.js"></script>

		<script>

				bootbox.alert({
					size: "small",
					title: "Rezerwacja",
					message: '@TempData["message"]'
				})
		</script>

	}

	<nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
		<a class="navbar-brand">Areo Klub</a>

		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
				<li class="nav-item">
					@Html.ActionLink("Home", "Index", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "nav-link" })
				</li>

				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Rezerwacje
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
						@Html.ActionLink("Lista rezerwacji", "Reservations", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
					</div>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Samoloty
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
						@Html.ActionLink("Spis Samolotów", "Samoloty", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
						@Html.ActionLink("Dodaj samolot", "AddPlane", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
						@Html.ActionLink("Usuń samolot", "DeletePlane", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })

					</div>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Serwis samoltów
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
						@Html.ActionLink("Dodaj serwis", "AddManuallyService", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
						@Html.ActionLink("Usuń serwis", "DeleteService", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
						@Html.ActionLink("Lista serwisów samolotów", "PlaneServices", "Admin", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "dropdown-item" })
					</div>
				</li>
				<li class="nav-item">
					@Html.ActionLink("Wyloguj", "Login", "Login", new { Name = Model.Name, Nickname = Model.NickName }, new { @class = "nav-link" })
				</li>
			</ul>
		</div>

	</nav>

	<div class="container-fluid">

		<h2 style="text-align:center; margin: 0 0 15px 0">Rozkład lotów dla @Model.Name</h2>
		<table style="margin: 10px;" class="table text-center">
			<thead class="thead-dark ">
				<tr>
					<th>
						Nazwa
					</th>
					@for (int i = 0; i <= 6; i++)
					{
						<th>
							@DateTime.Now.AddDays(i).ToShortDateString()
						</th>
					}
				</tr>
			</thead>
			@{int z = 0; }
			<tbody>
				@foreach (var Samolot in Model.Samoloty)
				{
					z = z + 1;

					<tr>
						<td class="align-middle">@Samolot.Nazwa</td>

						@for (int i = 0; i <= 6; i++)
						{
							z = z + 1;
							bool isService = false;

							foreach (var service in Model.Serwis)
							{
								if (Samolot.Nazwa == service.Samolot && DateTime.ParseExact(service.Data, "dd.MM.yyyy", CultureInfo.InvariantCulture) == DateTime.Now.Date.AddDays(i))
								{
									isService = true;
								}
							}


							<td class="align-middle">
								@if (isService == false)
								{
									@Html.Action("Rezerwacja", "Reservation", new { PlaneName = Samolot.Nazwa, Date = DateTime.Now.AddDays(i).ToShortDateString(), Name = Model.Name, Number = z, By = Model.Name, NickName = Model.NickName })
									@Html.Action("GetReservation", new { name = Samolot.Nazwa, data = DateTime.Now.AddDays(i).ToShortDateString(), username = Model.Name })
								}
								else
								{
									<div>Brak możliwości rezerwacji z powodu serwisu samolotu!</div>
								}
							</td>
						}

					</tr>

				}
			</tbody>
		</table>
	</div>


</body>
</html>